# 1- Criar partição primaria de 40G no hd de 120G
fdisk /dev/vdb <<EOF
n
p
1
2048
+40G
t
8e
p
w
EOF
# 2- Criação do partiçção fisica
pvcreate /dev/vdb1

# 3- Criação do grupo
vgcreate vgnew /dev/vdb1

# 4- Criação do volume lógico
lvcreate -L 20G -n lvnew1 vgnew

# 5- Formatação do volume lógico
mkfs.ext3 /dev/vgnew/lvnew1 # Sistema de ficheiro
# ou mkfs.ext3 /dev/mapper/vgnew-lvnew1

# 6-  Criar volume logico 2 com tamanho predeterminado "10G"
lvcreate -L 10G -n lvnew2 vgnew
mkfs.ext3 /dev/vgnew/lvnew2 # Sistema de ficheiro

# Montar as duas unidades
mkdir -p /mnt/pont1 && sudo mount /dev/vgnew/lvnew1 /mnt/pont1
mkdir -p /mnt/pont2 && sudo mount /dev/vgnew/lvnew2 /mnt/pont2
df -Th

# 7- Redimensionar o volume lógico
lvextend -l +100%FREE /dev/vgnew/lvnew2
df -Th
resize2fs /dev/vgnew/lvnew2 # Redimensionar o sistema de arquivos

# 8- Estender partição primaria
fdisk -l /dev/vdb # copie o Sector inicia e final do disco
# fdisk /dev/vdb
# Comandos: p, d, n, p, 1, [MESMO START], [Enter], t, 8e, w
umount /dev/vgnew/lvnew1
umount /dev/vgnew/lvnew2
vgchange -a n vgnew

fdisk /dev/vdb <<EOF
d
n
p
1
2048

t
8e
p
w
EOF

# 9- Recarregar
partprobe /dev/vdb
vgchange -a y vgnew


# 10- Redimensionar partição fisica
pvresize  /dev/vdb1

# 11- Comando para aumentar +50 GB ao lvnew2
lvextend -L +50G /dev/vgnew/lvnew2
resize2fs /dev/vgnew/lvnew2

# 12- Atribuir todo o espaço restante do vgnew que é 30GB
lvextend -l +100%FREE /dev/vgnew/lvnew1
resize2fs /dev/vgnew/lvnew1

# Redimensionar volume logico adicionando valor predeterminado "+5G"
lvresize -L +5G /dev/vgnew/lvnew2





⚠️ Importante: Por que é Seguro?
LVM armazena metadados no início da partição

Ao manter o mesmo Start Sector, não mexemos nos dados existentes

Só estendemos o final da partição para o espaço não alocado

Os dados do LVM permanecem intacto
